<main style="margin: 0; padding: 0; box-sizing: border-box">
  <img src="/images/mitid.png" alt="mitid logo" />
  <form onsubmit="return false" style="width: 100%">
    <button
      onclick="login()"
      style="width: 100%; height: 4rem; margin-top: 0.5rem; font-size: 1.2rem"
    >
      Submit
    </button>
  </form>
  <script>
    async function login() {
      let jwt_token = "{{token}}";
      let headers = { "Content-Type": "application/json" };
      if (jwt_token) {
        headers["Authorization"] = `Bearer ${jwt_token}`;
      }
      let conn = await fetch("/api-login", {
        method: "POST",
        headers,
      });
      let res = await conn.text();
      console.log("MITID says:", res);
      if (res == "NO") {
        parent.postMessage("NO", "*");
        return;
      }
      // SUCCESS
      // parent.postMessage("no", "*")
      parent.postMessage('{"cpr":"1","iat":"1000","exp":"1600"}', "*");
    }
  </script>
</main>
